% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  portuguese,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreport}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother


\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother



\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}


\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 
\usepackage[]{biblatex}
\addbibresource{references.bib}


\usepackage{cancel}
\KOMAoption{captions}{tableheading,figureheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Índice}
\else
  \newcommand\contentsname{Índice}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{Lista de Figuras}
\else
  \newcommand\listfigurename{Lista de Figuras}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{Lista de Tabelas}
\else
  \newcommand\listtablename{Lista de Tabelas}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figura}
\else
  \newcommand\figurename{Figura}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Tabela}
\else
  \newcommand\tablename{Tabela}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listagem}
\newcommand*\listoflistings{\listof{codelisting}{Lista de Listagens}}
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{exercise}{Exercício}[chapter]
\theoremstyle{definition}
\newtheorem{example}{Exemplo}[chapter]
\theoremstyle{plain}
\newtheorem{theorem}{Teorema}[chapter]
\theoremstyle{remark}
\AtBeginDocument{\renewcommand*{\proofname}{Comprovação}}
\newtheorem*{remark}{Comentário}
\newtheorem*{solution}{Solução}
\newtheorem{refremark}{Comentário}[chapter]
\newtheorem{refsolution}{Solução}[chapter]
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Anotações de Inferência Bayesiana},
  pdfauthor={Aulas de Luis G. Esteves \& Victor Fossaluza, digitadas por Gustavo S. Garone},
  pdflang={pt},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Anotações de Inferência Bayesiana}
\author{Aulas de Luis G. Esteves \& Victor Fossaluza, digitadas por
Gustavo S. Garone}
\date{2025-08-15}
\begin{document}
\maketitle

\renewcommand*\contentsname{Índice}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}

\bookmarksetup{startatroot}

\chapter{Inferência Bayesiana}\label{inferuxeancia-bayesiana}

\part{Inferência Bayesiana}

\chapter{O Pensamento Bayesiano}\label{o-pensamento-bayesiano}

\section{Inferência}\label{inferuxeancia}

Podemos dizer que inferência é qualquer processo racional de redução de
\textbf{incerteza}. Se não há incerteza, não há necessidade da
estatística.

\begin{example}[Bolas na
caixa]\protect\hypertarget{exm-urna}{}\label{exm-urna}

Considere uma caixa com 5 bolas, algumas verdes (\(v\)), e o restante
brancas (\(b\)). Suponha que amostramos duas bolas, sem reposição. Isto
é, retiramos duas bolas desta caixa, e que ambas as bolas retiradas
foram verdes. A partir deste experimento, podemos \emph{inferir} que
\(v \geq 2\), ou seja, ao menos duas bolas da caixa são verdes. Caso
retirássemos uma branca e uma verde, poderíamos naturalmente inferir que
ao menos uma bola da caixa é branca, e ao menos uma é verde.

\end{example}

Note que, mesmo após esse processo, a incerteza sobre a composição da
caixa contínua. Contudo, com a nova informação, ocorre uma
\emph{atualização da incerteza}.

A inferência estatística é, portanto, o processo de redução de
incertezas a partir de dados e métodos estatísticos. Neste contexto, a
\emph{Inferência Bayesiana} é a inferência estatística baseada na
perspectiva \emph{subjetiva} de probabilidade.

\begin{tcolorbox}[enhanced jigsaw, opacityback=0, colframe=quarto-callout-note-color-frame, bottomrule=.15mm, bottomtitle=1mm, breakable, coltitle=black, opacitybacktitle=0.6, left=2mm, colback=white, rightrule=.15mm, titlerule=0mm, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Probabilidade}, arc=.35mm, toprule=.15mm, leftrule=.75mm, colbacktitle=quarto-callout-note-color!10!white]

O objeto probabilidade pode ser estudada de diversas perspectivas.
Estamos acostumados com o \emph{cálculo de probabilidade}, em que
desenvolvemos teoremas e outros resultados a partir dos axiomas de
Kolmogorov.

\[
\begin{aligned}
P(A) \geq 0, \forall A \in \mathcal{F} \\
P(\Omega) = 1 \\
P\left(\bigcup\limits_{n=1}^\infty A_n\right) = \sum^\infty_{n=1} A_n
\end{aligned}
\]

Por outro lado, há pessoas que se ocupam em entender a probabilidade do
ponto de vista da \emph{Teoria da Medida}, preocupando-se em estudar a
probabilidade como uma função de medida.

Ainda assim, existe uma visão mais ``filosófica'' do estudo da
probabilidade, que se preocupa na \emph{interpretação} da probabilidade.
Uma interpretação
\href{https://inferencia-classica.netlify.app}{clássica} é da
probabilidade como medida de frequência, enquanto a interpretação
subjetiva da probabilidade, utilizada na inferência Bayesiana, toma a
probabilidade como uma medida de \emph{incerteza}.

Por exemplo, num lançamento de moedas, a teoria frequentista afirma que,
ao lançar uma moeda honesta um número grande de vezes, esperaria que
50\% dos lançamentos resultasse em cara. Por outro lado, na teoria
subjetiva da probabilidade, alguém que acredita que a moeda é honesta
diria, antes do primeiro lançamento desta, que não há razão de acreditar
que a moeda vá provavelmente cair cara, tão quanto acreditar que mais
provavelmente cairá coroa. Nesta visão, a probabilidade é um número que
\emph{mede, quantifica ou representa a incerteza} do observador sobre um
fenômeno.

Esta discussão sobre o significado de probabilidade é denominado
\emph{Teoria da Probabilidade}.

\end{tcolorbox}

\subsection{Cenários de Incerteza}\label{cenuxe1rios-de-incerteza}

Além do exemplo da caixa com bolas que discutimos anteriormente, podemos
pensar em outros cenários de incerteza:

\begin{example}[Erupções na
pele]\protect\hypertarget{exm-pele}{}\label{exm-pele}

Considere um indivíduo com erupções na pele. Este tipo de erupções pode
ser causado por doenças diversas, dentre elas, uma é considerada grave,
provocando incerteza no indivíduo sobre sua saúde. Sabendo disto, o
indivíduo vai ao hospital em busca de informações sobre sua condição. A
partir de experimentos, como exames médicos, a incerteza do indivíduo
sobre a doença e sua saúde é reduzida pelas informações obtidas.

\end{example}

\begin{example}[Avião
perdido]\protect\hypertarget{exm-aviao}{}\label{exm-aviao}

Em outro exemplo, considere que um avião caiu num corpo d'água e sua
localização exata é desconhecida. Conforme descobrimos informações do
avião, como partes encontradas no mar, consideração de oceanográficos e
climáticos, análise técnica do modelo do avião, resultados de buscas
passadas e outras informações, podemos gradativamente reduzir a região
de queda do avião, até encontrarmos o ponto exato ou muito próximo desta
queda.

Este exemplo é mais real do que pensa! Técnicas bayesianas foram
utilizadas na
\href{https://www.technologyreview.com/2014/05/27/13283/how-statisticians-found-air-france-flight-447-two-years-after-it-crashed-into-atlantic/}{busca
pelo infame voo 447}

\end{example}

Num último exemplo, suponha que estamos interessados em estudar a
eficácia de um medicamento na redução da taxa do colesterol. A incerteza
jaz exatamente na eficácia do medicamento, isto é, quanto a taxa de
colesterol é reduziada após uso do medicamento. Para esta análise,
coletaríamos amostras aleatórias simples. Suponha, por hipótese, que o
colesterol dos pacientes em estudo amostrados
(\(\boldsymbol{X}_n = (X_1, \dots, X_n)\) seguem uma distribuição
Normal, com variância 16 e média desconhecida que queremos inferir:

\[
X \sim (?,16)
\]

No modelo clássico, usaríamos de métodos como o uso do estimador não
viesado de variância uniformemente mínima. Por outro lado, o bayesiano
começaria com uma incerteza antes da coleta da amostra e, com a
informação obtida, atualizaria sua incerteza em uma nova distribuição:
\[
\mathcal{D} \stackrel{\boldsymbol{X}_n}{\rightarrow} \mathcal{D} \lvert x_1,
\dots, x_n
\]

Esta ferramenta de atualização de informação é o cerne da abordagem
Bayesiana, e será extensivamente estudada pelo curso.

\chapter{Teorema de Bayes}\label{teorema-de-bayes}

Da probabilidade, conhecemos o enunciado do Teorema de Bayes.

\begin{theorem}[Teorema de
Bayes]\protect\hypertarget{thm-bayes}{}\label{thm-bayes}

Sejam \(A_1, A_2, ... A_n \in \mathcal{A}\) eventos que particionam
\(\Omega\), isto é,
\(A_i \cap A_j = \emptyset, \bigcup_{i=1}^n A_i = \Omega,\) e \(D \in
\mathcal{A}\) um evento tal que \(P(D) > 0\). Então, para
\(i = 1, 2, \dots, n\),

\[
P(A_i \rvert D) = \frac{P(D \rvert A_i) P(A_i)}{\sum\limits^{n}_{j = 1} P(D \rvert
A_j)P(A_j)}
\]

\end{theorem}

\begin{tcolorbox}[enhanced jigsaw, opacityback=0, colframe=quarto-callout-note-color-frame, bottomrule=.15mm, bottomtitle=1mm, breakable, coltitle=black, opacitybacktitle=0.6, left=2mm, colback=white, rightrule=.15mm, titlerule=0mm, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Detalhes importantes}, arc=.35mm, toprule=.15mm, leftrule=.75mm, colbacktitle=quarto-callout-note-color!10!white]

Note que \(P(X=x \rvert \theta = \theta_i)\) é a \emph{função de
verossimilhança}. Note também que o denominador,
\(\sum\limits^{n}_{j = 1} P(D \rvert A_j)P(A_j)\), \textbf{\emph{não}}
depende de \(i\)!!!

\end{tcolorbox}

Note que, para o Exemplo~\ref{exm-urna},

\[
\begin{aligned}
E(\theta) &= \frac{5}{2} \\
E(\theta \rvert X_1 = 1, X_2 = 0)  &= 1 \cdot \frac{2}{10} + 2 \cdot {3}{10} + 3
\cdot \frac {3}{10} + 4 \cdot \frac{2}{10} = \frac{5}{2} \\
\mathrm{Var}(\theta \rvert X_1 = 1, X_2 = 0) &= E(\theta^2 \rvert X_1 = 1, X_2=  0) - E(\theta \rvert X_1 = 1, X_2
= 0)^2 \\ 
&= 1^2 \cdot \frac{2}{10} + 2^2 \cdot \frac{3}{10} + 3^2
\cdot \frac{3}{10} + 4^2 \cdot \frac{2}{10} - \frac{25}{4} = \frac{21}{20}
\end{aligned}
\]

\begin{exercise}[]\protect\hypertarget{exr-urnaoutraamostra}{}\label{exr-urnaoutraamostra}

Refaça o exercício (encontre a distribuição a posteriori de \(\theta\))
dado a amostra \(X_1 = 1, X_2 = 1\)

\end{exercise}

\begin{refsolution}
Pelo Teorema~\ref{thm-bayes},

\[
\frac{\frac{i}{5} \cdot \frac{i-1}{4} \cdot \frac{1}{6}}{\sum\limits^5_{j=0}
\frac{j}{5} \cdot \frac{j-1}{4} \cdot \frac{1}{6}} = \frac{i(i-1)}
{\sum\limits^5_{j=0}j(j-1)} = \frac{i(i-1)}{40}
\]

Um outro caminho para resolução envolve o uso de proporcionalidade.
Podemos observar que, pelo Teorema~\ref{thm-bayes}, \[
\begin{aligned}
P(\theta = i \rvert \boldsymbol{X} = (1,1)) &\propto
P(\boldsymbol{X} = (1,1) \rvert \theta = i)P(\theta = i) = \frac{i}{5} \cdot
\frac{i-1}{4} \cdot \frac{1}{6} \mathbb{1}_{\Theta}(i) \\
&= \frac{i(i-1)}{120}
\mathbb{1}_{\Theta}(i) \propto i(i-1) \mathbb{1}_{\Theta}(i)
\end{aligned}
\]

ou seja, podemos simplesmente nos preocupar com o numerador e dividir
(``normalizar'') pela soma dos termos:

\label{sol-urnaoutraamostra}

\end{refsolution}

\begin{example}[Informação sobre a
soma]\protect\hypertarget{exm-infosomaurna}{}\label{exm-infosomaurna}

Ainda no cenário do Exemplo~\ref{exm-urna}, considere a função
\(T(\boldsymbol{X}) = X_1 +
X_2\) do número de bolas verdes na amostra. Você é informado que
\(T(X_ = 1\). Vamos determinar a distribuição a posteriori de \(\theta\)
dado que \(X_1 + X_2 = 1\).

\[
P(\theta = i \rvert X_1 + X_2 = 1) = \frac{P(X_1 + X_2 = 1 \rvert \theta =
i)P(\theta=i)}{\sum\limits^5_{j=0}P(X_1 + X_2 = 1 \rvert \theta = j)P(\theta=j)}
\] usando da proporcionalidade, \[
\begin{aligned}
P(\theta = i \rvert X_1 + X_2 = 1) &\propto P(X_1 + X_2 \rvert \theta =
i)P(\theta = i)\\ 
&= \sum\limits_{(x_1,x_2) \in \mathfrak{X} : x_1 + x_2 = 1}
P(X_1 = x_1, X_2 = x_2 \rvert \theta = i)P(\theta = i) \\
&= [P(X_1 = 1, X_2 = 0 \rvert \theta = i) + P(X_1 = 0, X_2 = 1 \rvert \theta = i)]P(\theta = i) \\
&= \left[\frac{i}{5} \cdot \frac{(5-i)}{4} + \frac{5-i}{5} \cdot \frac{i}{4}\right] \cdot \frac{1}{6} \mathbb{1}_\Theta(i) \\
&= \frac{i(5-i)}{10} \cdot \frac{1}{6} \mathbb{1}_\Theta(i) \propto i(5-1)
\mathbb{1}_\Theta(i)
\end{aligned}
\]

Note que isso nos concede a mesma quantidade de informação para a
inferência que a amostra completa, ou seja, obtemos a mesma a posteriori
utilizando esta estatística. Isto ocorre uma vez que a função
\(T(\boldsymbol{X})\) é uma estatística \emph{suficiente} no sentido
bayesiano. Mais adiante, discutiremos isso com mais detalhes.

\end{example}


\printbibliography



\end{document}
